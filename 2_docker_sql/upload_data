{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2cbdc7ac-a293-4a90-83e2-0780b4ba005c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "78d5e25c-973b-4ee3-9303-ae74e8b7e506",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'2.3.3'"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.__version__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5a606917-516a-470a-b4b3-b98f781fb61e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df=pd.read_csv('earthquake_data_tsunami.csv')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8ded2c00-5351-4792-9f13-b8bfe58364e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>magnitude</th>\n",
       "      <th>cdi</th>\n",
       "      <th>mmi</th>\n",
       "      <th>sig</th>\n",
       "      <th>nst</th>\n",
       "      <th>dmin</th>\n",
       "      <th>gap</th>\n",
       "      <th>depth</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>tsunami</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7.0</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>768</td>\n",
       "      <td>117</td>\n",
       "      <td>0.509</td>\n",
       "      <td>17.0</td>\n",
       "      <td>14.000</td>\n",
       "      <td>-9.7963</td>\n",
       "      <td>159.596</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6.9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>735</td>\n",
       "      <td>99</td>\n",
       "      <td>2.229</td>\n",
       "      <td>34.0</td>\n",
       "      <td>25.000</td>\n",
       "      <td>-4.9559</td>\n",
       "      <td>100.738</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7.0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>755</td>\n",
       "      <td>147</td>\n",
       "      <td>3.125</td>\n",
       "      <td>18.0</td>\n",
       "      <td>579.000</td>\n",
       "      <td>-20.0508</td>\n",
       "      <td>-178.346</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7.3</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>833</td>\n",
       "      <td>149</td>\n",
       "      <td>1.865</td>\n",
       "      <td>21.0</td>\n",
       "      <td>37.000</td>\n",
       "      <td>-19.2918</td>\n",
       "      <td>-172.129</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6.6</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>670</td>\n",
       "      <td>131</td>\n",
       "      <td>4.998</td>\n",
       "      <td>27.0</td>\n",
       "      <td>624.464</td>\n",
       "      <td>-25.5948</td>\n",
       "      <td>178.278</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>777</th>\n",
       "      <td>7.7</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>912</td>\n",
       "      <td>427</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>60.000</td>\n",
       "      <td>13.0490</td>\n",
       "      <td>-88.660</td>\n",
       "      <td>2001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>778</th>\n",
       "      <td>6.9</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>745</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.400</td>\n",
       "      <td>56.7744</td>\n",
       "      <td>-153.281</td>\n",
       "      <td>2001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>779</th>\n",
       "      <td>7.1</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>776</td>\n",
       "      <td>372</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>103.000</td>\n",
       "      <td>-14.9280</td>\n",
       "      <td>167.170</td>\n",
       "      <td>2001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>780</th>\n",
       "      <td>6.8</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>711</td>\n",
       "      <td>64</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>33.000</td>\n",
       "      <td>6.6310</td>\n",
       "      <td>126.899</td>\n",
       "      <td>2001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>781</th>\n",
       "      <td>7.5</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>865</td>\n",
       "      <td>324</td>\n",
       "      <td>0.000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>33.000</td>\n",
       "      <td>6.8980</td>\n",
       "      <td>126.579</td>\n",
       "      <td>2001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>782 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     magnitude  cdi  mmi  sig  nst   dmin   gap    depth  latitude  longitude  \\\n",
       "0          7.0    8    7  768  117  0.509  17.0   14.000   -9.7963    159.596   \n",
       "1          6.9    4    4  735   99  2.229  34.0   25.000   -4.9559    100.738   \n",
       "2          7.0    3    3  755  147  3.125  18.0  579.000  -20.0508   -178.346   \n",
       "3          7.3    5    5  833  149  1.865  21.0   37.000  -19.2918   -172.129   \n",
       "4          6.6    0    2  670  131  4.998  27.0  624.464  -25.5948    178.278   \n",
       "..         ...  ...  ...  ...  ...    ...   ...      ...       ...        ...   \n",
       "777        7.7    0    8  912  427  0.000   0.0   60.000   13.0490    -88.660   \n",
       "778        6.9    5    7  745    0  0.000   0.0   36.400   56.7744   -153.281   \n",
       "779        7.1    0    7  776  372  0.000   0.0  103.000  -14.9280    167.170   \n",
       "780        6.8    0    5  711   64  0.000   0.0   33.000    6.6310    126.899   \n",
       "781        7.5    0    7  865  324  0.000   0.0   33.000    6.8980    126.579   \n",
       "\n",
       "     Year  Month  tsunami  \n",
       "0    2022     11        1  \n",
       "1    2022     11        0  \n",
       "2    2022     11        1  \n",
       "3    2022     11        1  \n",
       "4    2022     11        1  \n",
       "..    ...    ...      ...  \n",
       "777  2001      1        0  \n",
       "778  2001      1        0  \n",
       "779  2001      1        0  \n",
       "780  2001      1        0  \n",
       "781  2001      1        0  \n",
       "\n",
       "[782 rows x 13 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ad8df00c-9215-4b2f-9a34-2358dceb3fdf",
   "metadata": {},
   "outputs": [],
   "source": [
    "import duckdb\n",
    "df=duckdb.query(\"select * from 'earthquake_data_tsunami.csv'\").to_df()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a52bfeb7-e410-423f-846b-efe0e0b40d31",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>magnitude</th>\n",
       "      <th>cdi</th>\n",
       "      <th>mmi</th>\n",
       "      <th>sig</th>\n",
       "      <th>nst</th>\n",
       "      <th>dmin</th>\n",
       "      <th>gap</th>\n",
       "      <th>depth</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>Year</th>\n",
       "      <th>Month</th>\n",
       "      <th>tsunami</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7.0</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>768</td>\n",
       "      <td>117</td>\n",
       "      <td>0.509</td>\n",
       "      <td>17.0</td>\n",
       "      <td>14.000</td>\n",
       "      <td>-9.7963</td>\n",
       "      <td>159.5960</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6.9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>735</td>\n",
       "      <td>99</td>\n",
       "      <td>2.229</td>\n",
       "      <td>34.0</td>\n",
       "      <td>25.000</td>\n",
       "      <td>-4.9559</td>\n",
       "      <td>100.7380</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7.0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>755</td>\n",
       "      <td>147</td>\n",
       "      <td>3.125</td>\n",
       "      <td>18.0</td>\n",
       "      <td>579.000</td>\n",
       "      <td>-20.0508</td>\n",
       "      <td>-178.3460</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7.3</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>833</td>\n",
       "      <td>149</td>\n",
       "      <td>1.865</td>\n",
       "      <td>21.0</td>\n",
       "      <td>37.000</td>\n",
       "      <td>-19.2918</td>\n",
       "      <td>-172.1290</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>6.6</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>670</td>\n",
       "      <td>131</td>\n",
       "      <td>4.998</td>\n",
       "      <td>27.0</td>\n",
       "      <td>624.464</td>\n",
       "      <td>-25.5948</td>\n",
       "      <td>178.2780</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>7.0</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>755</td>\n",
       "      <td>142</td>\n",
       "      <td>4.578</td>\n",
       "      <td>26.0</td>\n",
       "      <td>660.000</td>\n",
       "      <td>-26.0442</td>\n",
       "      <td>178.3810</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>6.8</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>711</td>\n",
       "      <td>136</td>\n",
       "      <td>4.678</td>\n",
       "      <td>22.0</td>\n",
       "      <td>630.379</td>\n",
       "      <td>-25.9678</td>\n",
       "      <td>178.3630</td>\n",
       "      <td>2022</td>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>6.7</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "      <td>797</td>\n",
       "      <td>145</td>\n",
       "      <td>1.151</td>\n",
       "      <td>37.0</td>\n",
       "      <td>20.000</td>\n",
       "      <td>7.6712</td>\n",
       "      <td>-82.3396</td>\n",
       "      <td>2022</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>6.8</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>1179</td>\n",
       "      <td>175</td>\n",
       "      <td>2.137</td>\n",
       "      <td>92.0</td>\n",
       "      <td>20.000</td>\n",
       "      <td>18.3300</td>\n",
       "      <td>-102.9130</td>\n",
       "      <td>2022</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>7.6</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>1799</td>\n",
       "      <td>271</td>\n",
       "      <td>1.153</td>\n",
       "      <td>69.0</td>\n",
       "      <td>26.943</td>\n",
       "      <td>18.3667</td>\n",
       "      <td>-103.2520</td>\n",
       "      <td>2022</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   magnitude  cdi  mmi   sig  nst   dmin   gap    depth  latitude  longitude  \\\n",
       "0        7.0    8    7   768  117  0.509  17.0   14.000   -9.7963   159.5960   \n",
       "1        6.9    4    4   735   99  2.229  34.0   25.000   -4.9559   100.7380   \n",
       "2        7.0    3    3   755  147  3.125  18.0  579.000  -20.0508  -178.3460   \n",
       "3        7.3    5    5   833  149  1.865  21.0   37.000  -19.2918  -172.1290   \n",
       "4        6.6    0    2   670  131  4.998  27.0  624.464  -25.5948   178.2780   \n",
       "5        7.0    4    3   755  142  4.578  26.0  660.000  -26.0442   178.3810   \n",
       "6        6.8    1    3   711  136  4.678  22.0  630.379  -25.9678   178.3630   \n",
       "7        6.7    7    6   797  145  1.151  37.0   20.000    7.6712   -82.3396   \n",
       "8        6.8    8    7  1179  175  2.137  92.0   20.000   18.3300  -102.9130   \n",
       "9        7.6    9    8  1799  271  1.153  69.0   26.943   18.3667  -103.2520   \n",
       "\n",
       "   Year  Month  tsunami  \n",
       "0  2022     11        1  \n",
       "1  2022     11        0  \n",
       "2  2022     11        1  \n",
       "3  2022     11        1  \n",
       "4  2022     11        1  \n",
       "5  2022     11        1  \n",
       "6  2022     11        1  \n",
       "7  2022     10        1  \n",
       "8  2022      9        1  \n",
       "9  2022      9        1  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "32cd9d59-357a-4089-be58-56f3e9715d26",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: sqlalchemy in c:\\users\\lenovo\\appdata\\local\\programs\\python\\python313\\lib\\site-packages (2.0.44)\n",
      "Requirement already satisfied: greenlet>=1 in c:\\users\\lenovo\\appdata\\local\\programs\\python\\python313\\lib\\site-packages (from sqlalchemy) (3.2.4)\n",
      "Requirement already satisfied: typing-extensions>=4.6.0 in c:\\users\\lenovo\\appdata\\local\\programs\\python\\python313\\lib\\site-packages (from sqlalchemy) (4.15.0)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install sqlalchemy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "185f4fa7-e9ca-4c6f-a03f-4ef787a2a5b1",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sqlalchemy import create_engine"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "914381fb-6a37-46f0-a28f-819abd9fec77",
   "metadata": {},
   "outputs": [],
   "source": [
    "engine = create_engine('postgresql://root:root@localhost:5432/earth_quake')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a60620e2-5f56-4f38-b5e3-c3fc07843bbc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "CREATE TABLE earth_quake (\n",
      "\tmagnitude FLOAT(53), \n",
      "\tcdi BIGINT, \n",
      "\tmmi BIGINT, \n",
      "\tsig BIGINT, \n",
      "\tnst BIGINT, \n",
      "\tdmin FLOAT(53), \n",
      "\tgap FLOAT(53), \n",
      "\tdepth FLOAT(53), \n",
      "\tlatitude FLOAT(53), \n",
      "\tlongitude FLOAT(53), \n",
      "\t\"Year\" BIGINT, \n",
      "\t\"Month\" BIGINT, \n",
      "\ttsunami BIGINT\n",
      ")\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(pd.io.sql.get_schema(df, name='earth_quake', con=engine))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "82826177-4119-423f-968d-b283f3422e8f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "magnitude    0\n",
       "cdi          0\n",
       "mmi          0\n",
       "sig          0\n",
       "nst          0\n",
       "dmin         0\n",
       "gap          0\n",
       "depth        0\n",
       "latitude     0\n",
       "longitude    0\n",
       "Year         0\n",
       "Month        0\n",
       "tsunami      0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum() #kiem tra du lieu thieu"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "91496595-762f-4fde-8bb6-9df94c473834",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.dropna(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "86a876c3-2d06-4aa0-a291-54e84b4e07d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    782.000000\n",
       "mean       6.941125\n",
       "std        0.445514\n",
       "min        6.500000\n",
       "25%        6.600000\n",
       "50%        6.800000\n",
       "75%        7.100000\n",
       "max        9.100000\n",
       "Name: magnitude, dtype: float64"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['tsunami'].value_counts()\n",
    "df['magnitude'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0dc1b504-c5d9-4271-94df-ff0f89a7c7e2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Đã ghi 100 dòng ở khối 0 trong 0.29 giây\n",
      "Đã ghi 100 dòng ở khối 1 trong 0.04 giây\n",
      "Đã ghi 100 dòng ở khối 2 trong 0.03 giây\n",
      "Đã ghi 100 dòng ở khối 3 trong 0.03 giây\n",
      "Đã ghi 100 dòng ở khối 4 trong 0.02 giây\n",
      "Đã ghi 100 dòng ở khối 5 trong 0.02 giây\n",
      "Đã ghi 100 dòng ở khối 6 trong 0.02 giây\n",
      "Đã ghi 82 dòng ở khối 7 trong 0.01 giây\n"
     ]
    }
   ],
   "source": [
    "from time import time\n",
    "import pandas as pd\n",
    "from sqlalchemy import create_engine\n",
    "\n",
    "chunk_size = 100\n",
    "engine = create_engine('postgresql://root:root@localhost:5432/earth_quake')\n",
    "\n",
    "for i, df_chunk in enumerate(pd.read_csv('earthquake_data_tsunami.csv', chunksize=chunk_size)):\n",
    "    # Chuyển đổi kiểu dữ liệu nếu cần\n",
    "    # df_chunk['date'] = pd.to_datetime(df_chunk['date'])\n",
    "\n",
    "    start = time()\n",
    "    df_chunk.to_sql(name='earth_quake', con=engine, if_exists='append', index=False)\n",
    "    print(f\"Đã ghi {len(df_chunk)} dòng ở khối {i} trong {round(time() - start, 2)} giây\")\n",
    "    \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "67cd76b3-0675-4344-83ca-9f7978dc363f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
